(function(amdDefine){amdDefine.amd=amdDefine.amd||{},amdDefine("_anone1cb5541d21252861e8b2d3b0d85e101_",["require"],function(amdRequire){var require=function(a,b){var x;try{x=amdRequire(a)}catch(e){}return x||browserifyRequire(a,b)},browserifyRequire=function(file,cwd){var resolved=require.resolve(file,cwd||"/"),mod=require.modules[resolved];if(!mod)throw new Error("Failed to resolve module "+file+", tried "+resolved);var res=mod._cached?mod._cached:mod();return res};return require.paths=[],require.modules={},require.extensions=[".js",".coffee"],require._core={assert:!0,events:!0,fs:!0,path:!0,vm:!0},require.resolve=function(){return function(x,cwd){function loadAsFileSync(x){if(require.modules[x])return x;for(var i=0;i<require.extensions.length;i++){var ext=require.extensions[i];if(require.modules[x+ext])return x+ext}}function loadAsDirectorySync(x){x=x.replace(/\/+$/,"");var pkgfile=x+"/package.json";if(require.modules[pkgfile]){var pkg=require.modules[pkgfile](),b=pkg.browserify;if(typeof b=="object"&&b.main){var m=loadAsFileSync(path.resolve(x,b.main));if(m)return m}else if(typeof b=="string"){var m=loadAsFileSync(path.resolve(x,b));if(m)return m}else if(pkg.main){var m=loadAsFileSync(path.resolve(x,pkg.main));if(m)return m}}return loadAsFileSync(x+"/index")}function loadNodeModulesSync(x,start){var dirs=nodeModulesPathsSync(start);for(var i=0;i<dirs.length;i++){var dir=dirs[i],m=loadAsFileSync(dir+"/"+x);if(m)return m;var n=loadAsDirectorySync(dir+"/"+x);if(n)return n}var m=loadAsFileSync(x);if(m)return m}function nodeModulesPathsSync(start){var parts;start==="/"?parts=[""]:parts=path.normalize(start).split("/");var dirs=[];for(var i=parts.length-1;i>=0;i--){if(parts[i]==="node_modules")continue;var dir=parts.slice(0,i+1).join("/")+"/node_modules";dirs.push(dir)}return dirs}cwd||(cwd="/");if(require._core[x])return x;var path=require.modules.path();cwd=path.resolve("/",cwd);var y=cwd||"/";if(x.match(/^(?:\.\.?\/|\/)/)){var m=loadAsFileSync(path.resolve(y,x))||loadAsDirectorySync(path.resolve(y,x));if(m)return m}var n=loadNodeModulesSync(x,y);if(n)return n;throw new Error("Cannot find module '"+x+"'")}}(),require.alias=function(from,to){var path=require.modules.path(),res=null;try{res=require.resolve(from+"/package.json","/")}catch(err){res=require.resolve(from,"/")}var basedir=path.dirname(res),keys=(Object.keys||function(obj){var res=[];for(var key in obj)res.push(key);return res})(require.modules);for(var i=0;i<keys.length;i++){var key=keys[i];if(key.slice(0,basedir.length+1)===basedir+"/"){var f=key.slice(basedir.length);require.modules[to+f]=require.modules[basedir+f]}else key===basedir&&(require.modules[to]=require.modules[basedir])}},require.define=function(filename,fn){var dirname=require._core[filename]?"":require.modules.path().dirname(filename),require_=function(file){return require(file,dirname)};require_.resolve=function(name){return require.resolve(name,dirname)},require_.modules=require.modules,require_.define=require.define;var module_={exports:{}};require.modules[filename]=function(){return require.modules[filename]._cached=module_.exports,fn.call(module_.exports,require_,module_,module_.exports,dirname,filename),require.modules[filename]._cached=module_.exports,module_.exports}},typeof process=="undefined"&&(process={}),process.nextTick||(process.nextTick=function(){var queue=[],canPost=typeof window!="undefined"&&window.postMessage&&window.addEventListener;return canPost&&window.addEventListener("message",function(ev){if(ev.source===window&&ev.data==="browserify-tick"){ev.stopPropagation();if(queue.length>0){var fn=queue.shift();fn()}}},!0),function(fn){canPost?(queue.push(fn),window.postMessage("browserify-tick","*")):setTimeout(fn,0)}}()),process.title||(process.title="browser"),process.binding||(process.binding=function(name){if(name==="evals")return require("vm");throw new Error("No such module")}),process.cwd||(process.cwd=function(){return"."}),process.env||(process.env={}),process.argv||(process.argv=[]),require.define("path",function(require,module,exports,__dirname,__filename){function filter(xs,fn){var res=[];for(var i=0;i<xs.length;i++)fn(xs[i],i,xs)&&res.push(xs[i]);return res}function normalizeArray(parts,allowAboveRoot){var up=0;for(var i=parts.length;i>=0;i--){var last=parts[i];last=="."?parts.splice(i,1):last===".."?(parts.splice(i,1),up++):up&&(parts.splice(i,1),up--)}if(allowAboveRoot)for(;up--;up)parts.unshift("..");return parts}var splitPathRe=/^(.+\/(?!$)|\/)?((?:.+?)?(\.[^.]*)?)$/;exports.resolve=function(){var resolvedPath="",resolvedAbsolute=!1;for(var i=arguments.length;i>=-1&&!resolvedAbsolute;i--){var path=i>=0?arguments[i]:process.cwd();if(typeof path!="string"||!path)continue;resolvedPath=path+"/"+resolvedPath,resolvedAbsolute=path.charAt(0)==="/"}return resolvedPath=normalizeArray(filter(resolvedPath.split("/"),function(p){return!!p}),!resolvedAbsolute).join("/"),(resolvedAbsolute?"/":"")+resolvedPath||"."},exports.normalize=function(path){var isAbsolute=path.charAt(0)==="/",trailingSlash=path.slice(-1)==="/";return path=normalizeArray(filter(path.split("/"),function(p){return!!p}),!isAbsolute).join("/"),!path&&!isAbsolute&&(path="."),path&&trailingSlash&&(path+="/"),(isAbsolute?"/":"")+path},exports.join=function(){var paths=Array.prototype.slice.call(arguments,0);return exports.normalize(filter(paths,function(p,index){return p&&typeof p=="string"}).join("/"))},exports.dirname=function(path){var dir=splitPathRe.exec(path)[1]||"",isWindows=!1;return dir?dir.length===1||isWindows&&dir.length<=3&&dir.charAt(1)===":"?dir:dir.substring(0,dir.length-1):"."},exports.basename=function(path,ext){var f=splitPathRe.exec(path)[2]||"";return ext&&f.substr(-1*ext.length)===ext&&(f=f.substr(0,f.length-ext.length)),f},exports.extname=function(path){return splitPathRe.exec(path)[3]||""}}),require.define("/node_modules/olark-targeting-plugin/package.json",function(require,module,exports,__dirname,__filename){module.exports={main:"./olark-targeting-plugin"}}),require.define("/node_modules/olark-targeting-plugin/olark-targeting-plugin.js",function(require,module,exports,__dirname,__filename){"use strict";var _=require("underscore"),rulemaker=require("./rulemaker"),json=require("./json");exports.activate=function(olark,conf){var jsonRules=json.encode(conf.system.rules),realRules=json.decode(jsonRules,rulemaker.reviveJSON);_.each(realRules,function(rule){rule.activate(olark,conf)})}}),require.define("/node_modules/underscore/package.json",function(require,module,exports,__dirname,__filename){module.exports={main:"underscore.js"}}),require.define("/node_modules/underscore/underscore.js",function(require,module,exports,__dirname,__filename){(function(){function eq(a,b,stack){if(a===b)return a!==0||1/a==1/b;if(a==null||b==null)return a===b;a._chain&&(a=a._wrapped),b._chain&&(b=b._wrapped);if(a.isEqual&&_.isFunction(a.isEqual))return a.isEqual(b);if(b.isEqual&&_.isFunction(b.isEqual))return b.isEqual(a);var className=toString.call(a);if(className!=toString.call(b))return!1;switch(className){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:a==0?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if(typeof a!="object"||typeof b!="object")return!1;var length=stack.length;while(length--)if(stack[length]==a)return!0;stack.push(a);var size=0,result=!0;if(className=="[object Array]"){size=a.length,result=size==b.length;if(result)while(size--)if(!(result=size in a==size in b&&eq(a[size],b[size],stack)))break}else{if("constructor"in a!="constructor"in b||a.constructor!=b.constructor)return!1;for(var key in a)if(_.has(a,key)){size++;if(!(result=_.has(b,key)&&eq(a[key],b[key],stack)))break}if(result){for(key in b)if(_.has(b,key)&&!(size--))break;result=!size}}return stack.pop(),result}var root=this,previousUnderscore=root._,breaker={},ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype,slice=ArrayProto.slice,unshift=ArrayProto.unshift,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty,nativeForEach=ArrayProto.forEach,nativeMap=ArrayProto.map,nativeReduce=ArrayProto.reduce,nativeReduceRight=ArrayProto.reduceRight,nativeFilter=ArrayProto.filter,nativeEvery=ArrayProto.every,nativeSome=ArrayProto.some,nativeIndexOf=ArrayProto.indexOf,nativeLastIndexOf=ArrayProto.lastIndexOf,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind,_=function(obj){return new wrapper(obj)};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=_),exports._=_):root._=_,_.VERSION="1.3.1";var each=_.each=_.forEach=function(obj,iterator,context){if(obj==null)return;if(nativeForEach&&obj.forEach===nativeForEach)obj.forEach(iterator,context);else if(obj.length===+obj.length){for(var i=0,l=obj.length;i<l;i++)if(i in obj&&iterator.call(context,obj[i],i,obj)===breaker)return}else for(var key in obj)if(_.has(obj,key)&&iterator.call(context,obj[key],key,obj)===breaker)return};_.map=_.collect=function(obj,iterator,context){var results=[];return obj==null?results:nativeMap&&obj.map===nativeMap?obj.map(iterator,context):(each(obj,function(value,index,list){results[results.length]=iterator.call(context,value,index,list)}),obj.length===+obj.length&&(results.length=obj.length),results)},_.reduce=_.foldl=_.inject=function(obj,iterator,memo,context){var initial=arguments.length>2;obj==null&&(obj=[]);if(nativeReduce&&obj.reduce===nativeReduce)return context&&(iterator=_.bind(iterator,context)),initial?obj.reduce(iterator,memo):obj.reduce(iterator);each(obj,function(value,index,list){initial?memo=iterator.call(context,memo,value,index,list):(memo=value,initial=!0)});if(!initial)throw new TypeError("Reduce of empty array with no initial value");return memo},_.reduceRight=_.foldr=function(obj,iterator,memo,context){var initial=arguments.length>2;obj==null&&(obj=[]);if(nativeReduceRight&&obj.reduceRight===nativeReduceRight)return context&&(iterator=_.bind(iterator,context)),initial?obj.reduceRight(iterator,memo):obj.reduceRight(iterator);var reversed=_.toArray(obj).reverse();return context&&!initial&&(iterator=_.bind(iterator,context)),initial?_.reduce(reversed,iterator,memo,context):_.reduce(reversed,iterator)},_.find=_.detect=function(obj,iterator,context){var result;return any(obj,function(value,index,list){if(iterator.call(context,value,index,list))return result=value,!0}),result},_.filter=_.select=function(obj,iterator,context){var results=[];return obj==null?results:nativeFilter&&obj.filter===nativeFilter?obj.filter(iterator,context):(each(obj,function(value,index,list){iterator.call(context,value,index,list)&&(results[results.length]=value)}),results)},_.reject=function(obj,iterator,context){var results=[];return obj==null?results:(each(obj,function(value,index,list){iterator.call(context,value,index,list)||(results[results.length]=value)}),results)},_.every=_.all=function(obj,iterator,context){var result=!0;return obj==null?result:nativeEvery&&obj.every===nativeEvery?obj.every(iterator,context):(each(obj,function(value,index,list){if(!(result=result&&iterator.call(context,value,index,list)))return breaker}),result)};var any=_.some=_.any=function(obj,iterator,context){iterator||(iterator=_.identity);var result=!1;return obj==null?result:nativeSome&&obj.some===nativeSome?obj.some(iterator,context):(each(obj,function(value,index,list){if(result||(result=iterator.call(context,value,index,list)))return breaker}),!!result)};_.include=_.contains=function(obj,target){var found=!1;return obj==null?found:nativeIndexOf&&obj.indexOf===nativeIndexOf?obj.indexOf(target)!=-1:(found=any(obj,function(value){return value===target}),found)},_.invoke=function(obj,method){var args=slice.call(arguments,2);return _.map(obj,function(value){return(_.isFunction(method)?method||value:value[method]).apply(value,args)})},_.pluck=function(obj,key){return _.map(obj,function(value){return value[key]})},_.max=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0])return Math.max.apply(Math,obj);if(!iterator&&_.isEmpty(obj))return-Infinity;var result={computed:-Infinity};return each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed>=result.computed&&(result={value:value,computed:computed})}),result.value},_.min=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0])return Math.min.apply(Math,obj);if(!iterator&&_.isEmpty(obj))return Infinity;var result={computed:Infinity};return each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed<result.computed&&(result={value:value,computed:computed})}),result.value},_.shuffle=function(obj){var shuffled=[],rand;return each(obj,function(value,index,list){index==0?shuffled[0]=value:(rand=Math.floor(Math.random()*(index+1)),shuffled[index]=shuffled[rand],shuffled[rand]=value)}),shuffled},_.sortBy=function(obj,iterator,context){return _.pluck(_.map(obj,function(value,index,list){return{value:value,criteria:iterator.call(context,value,index,list)}}).sort(function(left,right){var a=left.criteria,b=right.criteria;return a<b?-1:a>b?1:0}),"value")},_.groupBy=function(obj,val){var result={},iterator=_.isFunction(val)?val:function(obj){return obj[val]};return each(obj,function(value,index){var key=iterator(value,index);(result[key]||(result[key]=[])).push(value)}),result},_.sortedIndex=function(array,obj,iterator){iterator||(iterator=_.identity);var low=0,high=array.length;while(low<high){var mid=low+high>>1;iterator(array[mid])<iterator(obj)?low=mid+1:high=mid}return low},_.toArray=function(iterable){return iterable?iterable.toArray?iterable.toArray():_.isArray(iterable)?slice.call(iterable):_.isArguments(iterable)?slice.call(iterable):_.values(iterable):[]},_.size=function(obj){return _.toArray(obj).length},_.first=_.head=function(array,n,guard){return n!=null&&!guard?slice.call(array,0,n):array[0]},_.initial=function(array,n,guard){return slice.call(array,0,array.length-(n==null||guard?1:n))},_.last=function(array,n,guard){return n!=null&&!guard?slice.call(array,Math.max(array.length-n,0)):array[array.length-1]},_.rest=_.tail=function(array,index,guard){return slice.call(array,index==null||guard?1:index)},_.compact=function(array){return _.filter(array,function(value){return!!value})},_.flatten=function(array,shallow){return _.reduce(array,function(memo,value){return _.isArray(value)?memo.concat(shallow?value:_.flatten(value)):(memo[memo.length]=value,memo)},[])},_.without=function(array){return _.difference(array,slice.call(arguments,1))},_.uniq=_.unique=function(array,isSorted,iterator){var initial=iterator?_.map(array,iterator):array,result=[];return _.reduce(initial,function(memo,el,i){if(0==i||(isSorted===!0?_.last(memo)!=el:!_.include(memo,el)))memo[memo.length]=el,result[result.length]=array[i];return memo},[]),result},_.union=function(){return _.uniq(_.flatten(arguments,!0))},_.intersection=_.intersect=function(array){var rest=slice.call(arguments,1);return _.filter(_.uniq(array),function(item){return _.every(rest,function(other){return _.indexOf(other,item)>=0})})},_.difference=function(array){var rest=_.flatten(slice.call(arguments,1));return _.filter(array,function(value){return!_.include(rest,value)})},_.zip=function(){var args=slice.call(arguments),length=_.max(_.pluck(args,"length")),results=new Array(length);for(var i=0;i<length;i++)results[i]=_.pluck(args,""+i);return results},_.indexOf=function(array,item,isSorted){if(array==null)return-1;var i,l;if(isSorted)return i=_.sortedIndex(array,item),array[i]===item?i:-1;if(nativeIndexOf&&array.indexOf===nativeIndexOf)return array.indexOf(item);for(i=0,l=array.length;i<l;i++)if(i in array&&array[i]===item)return i;return-1},_.lastIndexOf=function(array,item){if(array==null)return-1;if(nativeLastIndexOf&&array.lastIndexOf===nativeLastIndexOf)return array.lastIndexOf(item);var i=array.length;while(i--)if(i in array&&array[i]===item)return i;return-1},_.range=function(start,stop,step){arguments.length<=1&&(stop=start||0,start=0),step=arguments[2]||1;var len=Math.max(Math.ceil((stop-start)/step),0),idx=0,range=new Array(len);while(idx<len)range[idx++]=start,start+=step;return range};var ctor=function(){};_.bind=function(func,context){var bound,args;if(func.bind===nativeBind&&nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(!_.isFunction(func))throw new TypeError;return args=slice.call(arguments,2),bound=function(){if(this instanceof bound){ctor.prototype=func.prototype;var self=new ctor,result=func.apply(self,args.concat(slice.call(arguments)));return Object(result)===result?result:self}return func.apply(context,args.concat(slice.call(arguments)))}},_.bindAll=function(obj){var funcs=slice.call(arguments,1);return funcs.length==0&&(funcs=_.functions(obj)),each(funcs,function(f){obj[f]=_.bind(obj[f],obj)}),obj},_.memoize=function(func,hasher){var memo={};return hasher||(hasher=_.identity),function(){var key=hasher.apply(this,arguments);return _.has(memo,key)?memo[key]:memo[key]=func.apply(this,arguments)}},_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(func,args)},wait)},_.defer=function(func){return _.delay.apply(_,[func,1].concat(slice.call(arguments,1)))},_.throttle=function(func,wait){var context,args,timeout,throttling,more,whenDone=_.debounce(function(){more=throttling=!1},wait);return function(){context=this,args=arguments;var later=function(){timeout=null,more&&func.apply(context,args),whenDone()};timeout||(timeout=setTimeout(later,wait)),throttling?more=!0:func.apply(context,args),whenDone(),throttling=!0}},_.debounce=function(func,wait){var timeout;return function(){var context=this,args=arguments,later=function(){timeout=null,func.apply(context,args)};clearTimeout(timeout),timeout=setTimeout(later,wait)}},_.once=function(func){var ran=!1,memo;return function(){return ran?memo:(ran=!0,memo=func.apply(this,arguments))}},_.wrap=function(func,wrapper){return function(){var args=[func].concat(slice.call(arguments,0));return wrapper.apply(this,args)}},_.compose=function(){var funcs=arguments;return function(){var args=arguments;for(var i=funcs.length-1;i>=0;i--)args=[funcs[i].apply(this,args)];return args[0]}},_.after=function(times,func){return times<=0?func():function(){if(--times<1)return func.apply(this,arguments)}},_.keys=nativeKeys||function(obj){if(obj!==Object(obj))throw new TypeError("Invalid object");var keys=[];for(var key in obj)_.has(obj,key)&&(keys[keys.length]=key);return keys},_.values=function(obj){return _.map(obj,_.identity)},_.functions=_.methods=function(obj){var names=[];for(var key in obj)_.isFunction(obj[key])&&names.push(key);return names.sort()},_.extend=function(obj){return each(slice.call(arguments,1),function(source){for(var prop in source)obj[prop]=source[prop]}),obj},_.defaults=function(obj){return each(slice.call(arguments,1),function(source){for(var prop in source)obj[prop]==null&&(obj[prop]=source[prop])}),obj},_.clone=function(obj){return _.isObject(obj)?_.isArray(obj)?obj.slice():_.extend({},obj):obj},_.tap=function(obj,interceptor){return interceptor(obj),obj},_.isEqual=function(a,b){return eq(a,b,[])},_.isEmpty=function(obj){if(_.isArray(obj)||_.isString(obj))return obj.length===0;for(var key in obj)if(_.has(obj,key))return!1;return!0},_.isElement=function(obj){return!!obj&&obj.nodeType==1},_.isArray=nativeIsArray||function(obj){return toString.call(obj)=="[object Array]"},_.isObject=function(obj){return obj===Object(obj)},_.isArguments=function(obj){return toString.call(obj)=="[object Arguments]"},_.isArguments(arguments)||(_.isArguments=function(obj){return!!obj&&!!_.has(obj,"callee")}),_.isFunction=function(obj){return toString.call(obj)=="[object Function]"},_.isString=function(obj){return toString.call(obj)=="[object String]"},_.isNumber=function(obj){return toString.call(obj)=="[object Number]"},_.isNaN=function(obj){return obj!==obj},_.isBoolean=function(obj){return obj===!0||obj===!1||toString.call(obj)=="[object Boolean]"},_.isDate=function(obj){return toString.call(obj)=="[object Date]"},_.isRegExp=function(obj){return toString.call(obj)=="[object RegExp]"},_.isNull=function(obj){return obj===null},_.isUndefined=function(obj){return obj===void 0},_.has=function(obj,key){return hasOwnProperty.call(obj,key)},_.noConflict=function(){return root._=previousUnderscore,this},_.identity=function(value){return value},_.times=function(n,iterator,context){for(var i=0;i<n;i++)iterator.call(context,i)},_.escape=function(string){return(""+string).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},_.mixin=function(obj){each(_.functions(obj),function(name){addToWrapper(name,_[name]=obj[name])})};var idCounter=0;_.uniqueId=function(prefix){var id=idCounter++;return prefix?prefix+id:id},_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/.^/,unescape=function(code){return code.replace(/\\\\/g,"\\").replace(/\\'/g,"'")};_.template=function(str,data){var c=_.templateSettings,tmpl="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+str.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(c.escape||noMatch,function(match,code){return"',_.escape("+unescape(code)+"),'"}).replace(c.interpolate||noMatch,function(match,code){return"',"+unescape(code)+",'"}).replace(c.evaluate||noMatch,function(match,code){return"');"+unescape(code).replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",func=new Function("obj","_",tmpl);return data?func(data,_):function(data){return func.call(this,data,_)}},_.chain=function(obj){return _(obj).chain()};var wrapper=function(obj){this._wrapped=obj};_.prototype=wrapper.prototype;var result=function(obj,chain){return chain?_(obj).chain():obj},addToWrapper=function(name,func){wrapper.prototype[name]=function(){var args=slice.call(arguments);return unshift.call(args,this._wrapped),result(func.apply(_,args),this._chain)}};_.mixin(_),each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];wrapper.prototype[name]=function(){var wrapped=this._wrapped;method.apply(wrapped,arguments);var length=wrapped.length;return(name=="shift"||name=="splice")&&length===0&&delete wrapped[0],result(wrapped,this._chain)}}),each(["concat","join","slice"],function(name){var method=ArrayProto[name];wrapper.prototype[name]=function(){return result(method.apply(this._wrapped,arguments),this._chain)}}),wrapper.prototype.chain=function(){return this._chain=!0,this},wrapper.prototype.value=function(){return this._wrapped}}).call(this)}),require.define("/node_modules/olark-targeting-plugin/rulemaker.js",function(require,module,exports,__dirname,__filename){"use strict";var _=require("underscore"),boolmaker=require("./boolmaker"),stringmaker=require("./stringmaker"),mapTree=require("./overscore").mapTree,Rule=function(id,description,clause,actions,perPage,perVisit,perVisitor,enabled){this.$$id=id,this.$$description=description,this.$$clause=clause,this.$$actions=actions,this.$$perPage=perPage,this.$$perVisit=perVisit,this.$$perVisitor=perVisitor,this.$$enabled=enabled?!0:!1};Rule.reviveJSON=function(key,value){return value&&value.kind==="Rule"?new Rule(value.id,value.description,value.clause,value.actions,value.perPage,value.perVisit,value.perVisitor,value.enabled):value},Rule.prototype={activate:function(olark){if(this.$$enabled===!1)return;var clause=this.$$clause,actions=this.$$actions;olark("api.rules.defineRule",{id:this.$$id,description:this.$$description,condition:function(pass){olark("api.chat.__SPI_getLastOperatorPresence",function(presence){presence==="available"&&olark("api.visitor.getDetails",function(visitor){clause.evaluate({visitor:visitor})&&pass()})})},action:function(){olark("api.visitor.getDetails",function(visitor){_.each(actions,function(action){action.execute(olark,{visitor:visitor})})})},perPage:this.$$perPage,perVisit:this.$$perVisit,perVisitor:this.$$perVisitor})},toJSON:function(){return{kind:"Rule",id:this.$$id,description:this.$$description,clause:this.$$clause,actions:this.$$actions,perPage:this.$$perPage,perVisit:this.$$perVisit,perVisitor:this.$$perVisitor,enabled:this.$$enabled}}};var Action=function(methodName,methodOptions){this.$$methodName=methodName,this.$$methodOptions=methodOptions,this.$$templatedMethodOptions=mapTree(this.$$methodOptions,function(value){return _.isString(value)?stringmaker.compile(value):value})};Action.reviveJSON=function(key,value){return value&&value.kind==="Action"?new Action(value.method,value.options):value},Action.prototype={execute:function(olark,context){var renderedOptions={};this.$$templatedMethodOptions&&(renderedOptions=mapTree(this.$$templatedMethodOptions,function(value){return value.render?value.render(context):value}));var finalMethodName=this.$$methodName;finalMethodName==="api.chat.sendMessageToVisitor"&&(finalMethodName="api.box.__SPI_setPrechatWelcomeMessage",renderedOptions=renderedOptions.body),finalMethodName==="api.box.hide"&&(finalMethodName="api.box.__SPI_hideForDuration",renderedOptions={forVisit:!0});var olarkArguments=[finalMethodName,renderedOptions];olark.apply(olark,olarkArguments)},toJSON:function(){return{kind:"Action",method:this.$$methodName,options:this.$$methodOptions}}};var reviveJSON=function(key,value){return Rule.reviveJSON(key,Action.reviveJSON(key,boolmaker.reviveJSON(key,value)))};exports.reviveJSON=reviveJSON,exports.Rule=Rule,exports.Action=Action}),require.define("/node_modules/olark-targeting-plugin/boolmaker.js",function(require,module,exports,__dirname,__filename){"use strict";var _=require("underscore"),inherit=function(subklass,superklass,prototypeDefiner){var subklassPrototype=subklass.prototype=new superklass;subklassPrototype.constructor=subklass,subklassPrototype.$$super=superklass.prototype,prototypeDefiner&&prototypeDefiner(subklassPrototype)},AbstractClause=function(){};inherit(AbstractClause,Object,function(p){p.evaluate=function(context){throw new Error("evaluate() must be defined on every clause")}});var AndClause=function(clauses){this.$$clauses=clauses};AndClause.reviveJSON=function(key,value){return value&&value.kind==="AndClause"?new AndClause(value.clauses):value},inherit(AndClause,AbstractClause,function(p){p.evaluate=function(context){return _.reduceRight(this.$$clauses,function(a,b){return a instanceof AbstractClause&&(a=a.evaluate(context)),b instanceof AbstractClause&&(b=b.evaluate(context)),a&&b?!0:!1},!0)},p.toJSON=function(){return{kind:"AndClause",clauses:this.$$clauses}}});var OrClause=function(clauses){this.$$clauses=clauses};OrClause.reviveJSON=function(key,value){return value&&value.kind==="OrClause"?new OrClause(value.clauses):value},inherit(OrClause,AbstractClause,function(p){p.evaluate=function(context){return _.reduceRight(this.$$clauses,function(a,b){return a instanceof AbstractClause&&(a=a.evaluate(context)),b instanceof AbstractClause&&(b=b.evaluate(context)),a||b?!0:!1},!1)},p.toJSON=function(){return{kind:"OrClause",clauses:this.$$clauses}}});var AbstractComparisonClause=function(left,right){this.$$left=left,this.$$right=right};inherit(AbstractComparisonClause,AbstractClause,function(p){p.evaluate=function(context){var left=this.$$left,right=this.$$right;return left instanceof AbstractClause&&(left=left.evaluate(context)),right instanceof AbstractClause&&(right=right.evaluate(context)),this.$$compare(left,right)}});var EqualsClause=function(){AbstractComparisonClause.apply(this,arguments)};EqualsClause.reviveJSON=function(key,value){return value&&value.kind==="EqualsClause"?new EqualsClause(value.left,value.right):value},inherit(EqualsClause,AbstractComparisonClause,function(p){p.$$compare=function(left,right){return left===right},p.toJSON=function(){return{kind:"EqualsClause",left:this.$$left,right:this.$$right}}});var NotEqualsClause=function(){AbstractComparisonClause.apply(this,arguments)};NotEqualsClause.reviveJSON=function(key,value){return value&&value.kind==="NotEqualsClause"?new NotEqualsClause(value.left,value.right):value},inherit(NotEqualsClause,AbstractComparisonClause,function(p){p.$$compare=function(left,right){return left!==right},p.toJSON=function(){return{kind:"NotEqualsClause",left:this.$$left,right:this.$$right}}});var LessThanClause=function(){AbstractComparisonClause.apply(this,arguments)};LessThanClause.reviveJSON=function(key,value){return value&&value.kind==="LessThanClause"?new LessThanClause(value.left,value.right):value},inherit(LessThanClause,AbstractComparisonClause,function(p){p.$$compare=function(left,right){return left<right},p.toJSON=function(){return{kind:"LessThanClause",left:this.$$left,right:this.$$right}}});var GreaterThanClause=function(){AbstractComparisonClause.apply(this,arguments)};GreaterThanClause.reviveJSON=function(key,value){return value&&value.kind==="GreaterThanClause"?new GreaterThanClause(value.left,value.right):value},inherit(GreaterThanClause,AbstractComparisonClause,function(p){p.$$compare=function(left,right){return left>right},p.toJSON=function(){return{kind:"GreaterThanClause",left:this.$$left,right:this.$$right}}});var RegExClause=function(){AbstractComparisonClause.apply(this,arguments)};RegExClause.reviveJSON=function(key,value){return value&&value.kind==="RegExClause"?new RegExClause(value.left,value.right):value},inherit(RegExClause,AbstractComparisonClause,function(p){p.$$compare=function(left,right){return(new RegExp(right)).test(left)},p.toJSON=function(){return{kind:"RegExClause",left:this.$$left,right:this.$$right}}});var NegativeRegExClause=function(){AbstractComparisonClause.apply(this,arguments)};NegativeRegExClause.reviveJSON=function(key,value){return value&&value.kind==="NegativeRegExClause"?new NegativeRegExClause(value.left,value.right):value},inherit(NegativeRegExClause,AbstractComparisonClause,function(p){p.$$compare=function(left,right){return(new RegExp(right)).test(left)?!1:!0},p.toJSON=function(){return{kind:"NegativeRegExClause",left:this.$$left,right:this.$$right}}});var WildcardClause=function(){AbstractComparisonClause.apply(this,arguments)};WildcardClause.reviveJSON=function(key,value){return value&&value.kind==="WildcardClause"?new WildcardClause(value.left,value.right):value},inherit(WildcardClause,AbstractComparisonClause,function(p){p.$$compare=function(left,right){var escapedRegex=right.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),wildcardedRegex="^"+escapedRegex.replace(/\\\*/g,".*")+"$";return(new RegExp(wildcardedRegex)).test(left)},p.toJSON=function(){return{kind:"WildcardClause",left:this.$$left,right:this.$$right}}});var ContainsClause=function(left,right){var wildcardedRight="*"+right+"*";WildcardClause.call(this,left,wildcardedRight)};ContainsClause.reviveJSON=function(key,value){return value&&value.kind==="ContainsClause"?new ContainsClause(value.left,value.right):value},inherit(ContainsClause,WildcardClause,function(p){p.toJSON=function(){return{kind:"ContainsClause",left:this.$$left,right:this.$$right}}});var DoesNotContainClause=function(left,right){ContainsClause.apply(this,arguments)};DoesNotContainClause.reviveJSON=function(key,value){return value&&value.kind==="DoesNotContainClause"?new DoesNotContainClause(value.left,value.right):value},inherit(DoesNotContainClause,ContainsClause,function(p){p.$$compare=function(){return!ContainsClause.prototype.$$compare.apply(this,arguments)},p.toJSON=function(){return{kind:"DoesNotContainClause",left:this.$$left,right:this.$$right}}});var VariableClause=function(varname){this.$$varname=varname};VariableClause.reviveJSON=function(key,value){return value&&value.kind==="VariableClause"?new VariableClause(value.varname):value},inherit(VariableClause,AbstractClause,function(p){p.evaluate=function(context){context=context||{};var paths=this.$$varname.split(".");while(paths.length&&context){var key=paths.shift();context=key in context?context[key]:undefined}return context},p.toJSON=function(){return{kind:"VariableClause",varname:this.$$varname}}});var reviveJSON=function(key,value){return _.each(_.values(ALL_CLAUSE_CLASSES),function(clauseClass){value=clauseClass.reviveJSON(key,value)}),value};exports.reviveJSON=reviveJSON;var ALL_CLAUSE_CLASSES={AndClause:AndClause,OrClause:OrClause,EqualsClause:EqualsClause,VariableClause:VariableClause,LessThanClause:LessThanClause,GreaterThanClause:GreaterThanClause,RegExClause:RegExClause,WildcardClause:WildcardClause,ContainsClause:ContainsClause,DoesNotContainClause:DoesNotContainClause,NegativeRegExClause:NegativeRegExClause,NotEqualsClause:NotEqualsClause};_.each(_.keys(ALL_CLAUSE_CLASSES),function(className){exports[className]=ALL_CLAUSE_CLASSES[className]})}),require.define("/node_modules/olark-targeting-plugin/stringmaker.js",function(require,module,exports,__dirname,__filename){"use strict";var _=require("underscore"),compile=function(templateString){var render=function(context){return templateString.replace(/\{\{([a-zA-Z0-9\._]+)\}\}/g,function(match,varname){var currentContext=context;return _.forEach(varname.split("."),function(key){try{currentContext=key in currentContext?currentContext[key]:""}catch(e){}}),currentContext})};return{render:render}};exports.compile=compile}),require.define("/node_modules/olark-targeting-plugin/overscore.js",function(require,module,exports,__dirname,__filename){"use strict";var _=require("underscore"),mapTree=function(root,callback){if(_.isFunction(root))return callback(root);if(_.isArray(root))return _.map(root,function(value){return mapTree(value,callback)});var newTree=root;if(root&&typeof root=="object")try{var klass=function(){};klass.prototype=root,newTree=new klass}catch(e){throw new Error("mapTree expects constructors to be callable without arguments")}var keys;try{keys=_.keys(root)}catch(e){keys=[]}return _.each(keys,function(key){newTree[key]=mapTree(root[key],callback)}),callback(newTree)};exports.mapTree=mapTree}),require.define("/node_modules/olark-targeting-plugin/json.js",function(require,module,exports,__dirname,__filename){var isInOlarkBrowser=function(){return typeof window!="undefined"&&window.olark&&olark.__core&&olark.__core.framestorewithjson&&olark.__core.framestorewithjson.json};exports.encode=function(object){return isInOlarkBrowser()?olark.__core.framestorewithjson.json.encode(object):JSON.stringify(object)},exports.decode=function(string,reviver){return isInOlarkBrowser()?olark.__core.framestorewithjson.json.decode(string,reviver):JSON.parse(string,reviver)}}),browserifyRequire}),amdDefine("olark-targeting-plugin",["_anone1cb5541d21252861e8b2d3b0d85e101_"],function(localBrowserify){return localBrowserify("olark-targeting-plugin")})})(typeof define!="undefined"&&define.amd?define:function(a,b,c){var t=this;t[a]=(c||b)(function(x){return t[x]})})